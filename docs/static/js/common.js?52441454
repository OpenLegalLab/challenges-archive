(function($,window){if(window.location.pathname.endsWith('/log')){$('#dribs-tab-md').click();}
$('#next-dribs').click(function(e){e.preventDefault();e.stopPropagation();var $self=$(this);if($self.hasClass('disabled'))return;$self.addClass('disabled');$.get($self.attr('href'),function(d){$('section.timeline').append($(d).find('section.timeline').html());$next=$(d).find('#next-dribs');if($next.length){$self.removeClass('disabled').attr('href',$next.attr('href'));}else{$self.removeClass('btn-primary').html('BOF');}});})
$('.project-home .project-image-container').each(function(){var $self=$(this);var url=$self.data('href');if(url.length<6)return;var img=new Image();img.onload=function(){if(this.width>this.height>512||this.width>640)
return $self.addClass('overlay');this.id='overlayImage';$self.addClass('underlay').after(this);}
img.src=url;});function delay(callback,ms){var timer=0;return function(){var context=this,args=arguments;clearTimeout(timer);timer=setTimeout(function(){callback.apply(context,args);},ms||0);};}
var lastSearch=null;var searchForm=$('#search');var searchHolder=$('#navSearch');var searchAction=searchForm.data('action');var searchIgnore=searchForm.find('#id').val();searchForm.find('input[name="q"]').keyup(delay(function(e){if(e.keyCode==13){e.preventDefault();return false;}
runSearch($(this).val());},500));$('#navSearchButton').click(function(e){e.preventDefault();e.stopPropagation();searchHolder.toggleClass('hidden');});function runSearch(q){if(q.length<4||q.trim()==lastSearch)return;lastSearch=q.trim();$.get(searchAction+'?q='+q,function(d){var projects=d.projects;if(typeof searchIgnore!==undefined&&searchIgnore){const si=parseInt(searchIgnore);projects=projects.filter(function(d){return d.id!==si});}
$ul=$('#search-results').empty();$sm=$('#search-matches').empty();if(projects.length>0){$sm.html('<span class="user-score">'+(projects.length)+'</span> '+
'matches'+
(projects.length>3?'<i class="float-right">&#9654;&#9654;</i>':''));}
projects.forEach(function(p){$ul.append('<a class="col col-2 col-sm-2 col-md-4 col-lg-4 ms-auto mr-1 card project" '+
'target="_blank" '+
'href="'+p.url+'"'+
(p.image_url?' style="background-image:url('+p.image_url+'); padding-left:100px"':'')+'>'+
'<div class="card-body">'+
'<h5 class="card-title">'+p.name+'</h5>'+
'<p class="card-text">'+p.summary+'</p>'+
'</div>'+
'</a>');});});}
function checkSearchQuery(){let paramString=(new URL(document.location)).searchParams;let searchParams=new URLSearchParams(paramString);if(searchParams.has("q")){let q=searchParams.get("q");searchForm.find('input[name="q"]').val(q);runSearch(q);}}
var $navCategories=$('.nav-categories .btn-group label').click(function(e){$(this).parent().find('.active').removeClass('active');$(this).parent().addClass('active');var selected_id=$(this).find('input').attr('id');var $projects=$('.honeycomb .hexagon');var $infotext=$('.category-info');$('.honeycomb').removeClass('hide-challenges');if(selected_id===''||selected_id==='list'||selected_id==='challenges'){$projects.addClass('category-highlight');$('.category-container',$infotext).hide();$projects.removeClass('hexagon hexalist').addClass(selected_id==='list'?'hexalist':'hexagon');if(selected_id!=='')
$('.honeycomb').addClass('hide-challenges');}else{var $selected=$('[category-id="'+selected_id+'"]',$projects.parent());$projects.removeClass('category-highlight');$selected.addClass('category-highlight');$('.category-container',$infotext).hide();$('[category-id="'+selected_id+'"]',$infotext).show();}});$('.honeycomb .hexagon[data-toggle="tooltip"]').each(function(){var content=('<div>'+$(this).data('summary')+'</div>'+
($(this).data('hashtag')?'<span>'+$(this).data('hashtag')+'</span>':'')+
($(this).data('imageurl')?'<img src="'+
$(this).data('imageurl')+'">':'')+
'<p>'+$(this).data('status')+'</p>');$(this).tooltip({html:true,title:content});});$('#embed-link').click(function(e){e.preventDefault();e.stopPropagation();var url=$(this).attr('href')+'?embed=1';var code='<iframe src="'+url+'" style="width:100%;height:320px;background:transparent;border:none;overflow:hidden" scrolling="no"></iframe>';window.prompt('Share the event link in social media, or copy and paste this HTML code to embed on your site. For even better embedding, visit github.com/dribdat/backboard',code);});$('.profile-projects .row').each(function(){const ele=$(this)[0];ele.style.cursor='grab';let pos={top:0,left:0,x:0,y:0};const mouseDownHandler=function(e){ele.style.cursor='grabbing';ele.style.userSelect='none';pos={left:ele.scrollLeft,top:ele.scrollTop,x:e.clientX,y:e.clientY,};document.addEventListener('mousemove',mouseMoveHandler);document.addEventListener('mouseup',mouseUpHandler);};const mouseMoveHandler=function(e){const dx=e.clientX-pos.x;const dy=e.clientY-pos.y;ele.scrollTop=pos.top-dy;ele.scrollLeft=pos.left-dx;};const mouseUpHandler=function(){ele.style.cursor='grab';ele.style.removeProperty('user-select');document.removeEventListener('mousemove',mouseMoveHandler);document.removeEventListener('mouseup',mouseUpHandler);};ele.addEventListener('mousedown',mouseDownHandler);});$('#show-history').click(function(e){e.preventDefault();e.stopPropagation();$('.details .history').slideDown();});$('.details .history').hide();$('#issues-list').each(function(){var per_page=5;var $self=$(this);var userAndRepo=$self.data('github');var url_api='https://api.github.com/repos/'+userAndRepo+'/issues';var url_www='https://github.com/'+userAndRepo+'/issues';$.getJSON(url_api+'?per_page='+(per_page+1),function(data){$self.empty();$.each(data,function(index){if(index==per_page){return;}
$self.append('<a href="'+this.html_url+
'" class="list-group-item" target="_blank">'+
'<img src="'+this.user.avatar_url+'">&nbsp;'+this.title+'</a>');});});});$('.resizable').each(function(){var $self=$(this);$(window).on('load',function(){$self.resizable({resizeWidth:false,handleSelector:".win-size-grip"});});});function setDarkMode(toggle){dm=Boolean(window.darkmode);if(toggle)dm=!dm;$css=$('#css-bootswatch').first();if(dm){$('body').addClass('theme-dark');$('nav.navbar').removeClass('navbar-light');$('footer .darkmode span').html('Light');$css.attr('org-href',$css.attr('href'));$css.attr('href',$css.attr('alt-href'));}else{$('body').removeClass('theme-dark');$('nav.navbar').addClass('navbar-light');$('footer .darkmode span').html('Dark');$css.attr('href',$css.attr('org-href'));}
localStorage.setItem('darkmode',dm?'1':'0');window.darkmode=dm;}
window.darkmode=localStorage.getItem('darkmode')=='1';setDarkMode(false);$('.darkmode').click(function(e){e.preventDefault();e.stopPropagation();setDarkMode(true);});function init_clock(){$('.event-countdown').each(function(){var startdate=$(this).data('start');var datenow=Date.now();var datesched=Date.parse(startdate.replace(' ','T'));var timeleft=datesched-datenow;if(isNaN(timeleft)||timeleft<0)return;var unixtime=datesched/1000;new FlipDown(unixtime,$(this).attr('id')).start();});$('.carousel').carousel();}
init_clock();checkSearchQuery();}).call(this,jQuery,window);(function($,window){$('#autotext_url').each(function(){var checkAutotext=function(val,$ind){if(typeof val!=='string')return;if(val.trim()==='')return;$ind.removeClass('d-none').find('i').removeClass('fa-circle-o fa-check-circle-o').addClass('fa-check-circle-o').css('color','red');$('#is_autoupdate').click(function(){if($(this).is(':checked'))
if(!$indicator.find('button').click())
$(this).click();});};var $inputfield=$(this);var $indicator=$inputfield.parent().append('<span class="autotext-indicator d-none btn-group">'+
'<a title="Status" class="btn btn-lg btn-light btn-disabled"><i class="fa fa-circle-o"></i></a>'+
'<button class="btn btn-lg btn-warning" type="button">'+
'Sync content</button>'+
'</span>').find('.autotext-indicator');checkAutotext($inputfield.val(),$indicator);$inputfield.on('keyup',function(e){checkAutotext($inputfield.val(),$indicator);$('.template-select label input').prop('checked',false);});$indicator.find('button').click(function(e){e.preventDefault();e.stopPropagation();var url=$inputfield.val();var $button=$(this);$indicator.find('i').css('color','blue');$button.attr('disabled','disabled').html('Please wait ...');$.getJSON('/api/project/autofill?url='+url,function(data){$button.removeAttr('disabled').html('Refresh');if(typeof data.name==='undefined'||data.name===''){window.alert('Enter a valid link to sync from a supported site.');$('#is_autoupdate').prop('checked',false);$indicator.find('i').css('color','red');return;}
$indicator.find('i').css('color','green');if(!$('input#name').val())
$('input#name').val(data.name);if(!$('input#summary').val())
$('input#summary').val(data.summary);if(!$('input#webpage_url').val())
$('input#webpage_url').val(data.homepage_url);if(!$('input#source_url').val())
$('input#source_url').val(data.source_url);if(!$('input#contact_url').val())
$('input#contact_url').val(data.contact_url);if(!$('input#download_url').val())
$('input#download_url').val(data.download_url);if(!$('input#image_url').val())
$('input#image_url').val(data.image_url);});return true;});});$('.form-project-post label[for="has_progress"]').each(function(){var vparent=$(this).parent().parent().hide();var vinput=$(this).parent().find('input')[0];vinput.checked=false;$('.form-project-confirm input[type="checkbox"]').click(function(){vparent.show();all_checked=$('.form-project-confirm input[type="checkbox"]:not(:checked)').length===0;vinput.checked=all_checked;});});$('input#logo_color[type=text]').attr('type','color');$('.project-autotext').click(function(){$(this).addClass('active');});$('.template-select label input').change(function(){$('input#template').val($(this).val());$('#autotext_url').val('');});$('#uploadImage').each(function(){var $dialog=$(this);var $togglebtn=$('button[data-target="#uploadImage"]');var $longtext=$('.fld-longtext');if($longtext.length>0){$longtext.prepend($togglebtn.clone().show());}else{$dialog.find("[data-target='pitch']").hide();}
var $webpage_url=$('.fld-webpage_url');if($webpage_url.length>0){$webpage_url.prepend($togglebtn.clone().show());}else{$dialog.find("[data-target='weblink']").hide();}
var $imageurl=$('.fld-image_url,.fld-logo_url');if($imageurl.length>0){$imageurl.append($togglebtn.clone().show());}else{$dialog.find("[data-target='cover']").hide();}
var $postnote=$('.fld-note');if($postnote.length>0&&$('body').hasClass('projectpost')){$postnote.prev().prepend($togglebtn.clone().show());}else{$dialog.find("[data-target='post']").hide();}
var $inputfd=$dialog.find('input[type="file"]');$inputfd.change(function(){var imgfile=$inputfd[0].files[0];var maxsize=parseInt($inputfd.data('maxsize'));if(imgfile.size>maxsize){return alert("Please upload a smaller file (1 MB limit)");}
var fdd=new FormData();fdd.append('file',imgfile);$.ajax({url:'/api/project/uploader',type:'post',data:fdd,processData:false,contentType:false,success:function(response){if(response.indexOf('http')!==0){return alert('File could not be uploaded :(\n'+response);}
$dialog.find(".preview img").attr("src",response);$dialog.find(".preview input").val(response);$dialog.find(".hidden").show();$('#img-confirm').show().find('button').off("click").click(function(){if($(this).data('target')=='weblink'){$('#webpage_url').val(response);$('#is_webembed:not(:checked)').click();$dialog.modal('hide');}else if($(this).data('target')=='cover'){$('#image_url,#logo_url').val(response);$dialog.modal('hide');}else if($(this).data('target')=='post'){var imglink='![]('+response+')';$('#note').val(imglink+' '+$('#note').val());$dialog.modal('hide');}else if($(this).data('target')=='pitch'){var imglink='![ Title ]('+response+')';if(typeof window.toasteditor!=='undefined'){window.toasteditor.insertText(imglink);}else{$('#longtext').val($('#longtext').val()+
'\n\n'+imglink);}
$dialog.modal('hide');}else{if(navigator.clipboard){navigator.clipboard.writeText(response);$dialog.modal('hide');}else{$dialog.find(".preview input").click().select();document.execCommand("copy");}}});},error:function(e){alert("Sorry, an error has occurred.\n"+e.statusText);}});});});$('#uploadFile').each(function(){var $dialog=$(this);var $togglebtn=$('button[data-target="#uploadFile"]');var $longtext=$('.fld-longtext');var $webpageurl=$('.fld-webpage_url');$longtext.prepend($togglebtn.clone().show());$webpageurl.prepend($togglebtn.clone().show());var $inputfd=$dialog.find('input[type="file"]');$inputfd.change(function(){var thefile=$inputfd[0].files[0];var maxsize=parseInt($inputfd.data('maxsize'));if(thefile.size>maxsize){return alert("Please upload a smaller file (1 MB limit)");}
var fdd=new FormData();fdd.append('file',thefile);$.ajax({url:'/api/project/uploader',type:'post',data:fdd,processData:false,contentType:false,success:function(response){if(response.indexOf('http')!==0){return alert('File could not be uploaded :(\n'+response);}
var path=$inputfd.val();var filename=path.split(/(\\|\/)/g).pop();$dialog.find(".preview input").val(response);$dialog.find(".hidden").show();$('#file-confirm').show().find('button').off("click").click(function(){if($(this).data('target')=='weblink'){$('#webpage_url').val(response);$('#is_webembed:not(:checked)').click();$dialog.modal('hide');}else if($(this).data('target')=='pitch'){var fileLink='📎 ['+filename+']('+response+')';if(typeof window.toasteditor!=='undefined'){window.toasteditor.insertText(fileLink);}else{$('#longtext').val($('#longtext').val()+
'\n\n'+fileLink);}
$dialog.modal('hide');}else{if(navigator.clipboard){navigator.clipboard.writeText(response);$dialog.modal('hide');}else{$dialog.find(".preview input").click().select();document.execCommand("copy");}}});},error:function(e){alert("Sorry, an error has occurred.\n"+e.statusText);}});});});$('.admin-defaults button').click(function(){$('input#name').val($(this).text());});$("#importEvent form").submit(function(e){var $form=$(this);if($form.find('input[type="file"]').val().length>0)return;e.preventDefault();var url=$form.attr('action');$form.find('input[type="submit"]').addClass('disabled');$form.find('.message-ok,.message-error').hide();$.ajax({type:"POST",url:url,data:$form.serialize(),success:function(data){console.log(data);if(data.status=='Error'){$form.find('.message-error').html(data.errors.join('\n')).show();}else{$form.find('.message-ok').show();}
$form.find('input[type="submit"]').removeClass('disabled');},error:function(err){$form.find('input[type="submit"]').removeClass('disabled');console.error(err.statusText);$form.find('.message-error').show();}});});function activate_editor(){if(typeof toastui!=='object')return;const $longtext=$('#longtext');if(!$longtext.length)return;$longtext.after('<div id="mdeditor" style="text-align:left"></div>');const toasteditor=window.toasteditor=new toastui.Editor({el:document.querySelector('#mdeditor'),previewStyle:'tab',height:'500px',initialValue:$longtext.hide().text(),usageStatistics:false,toolbarItems:[['heading','bold','italic'],['hr','quote','strike'],['ul','ol'],['table','link'],['code','codeblock'],]});$longtext.parents('form').submit(function(){$longtext.val(toasteditor.getMarkdown());});localStorage.setItem('markdownhelper','1');const $activateEditor=$('#activateEditor');$activateEditor.find('[data-do="activate"]').hide();$activateEditor.find('[data-do="reset"]').show().click(function(){if(window.confirm('Save changes first! Continue?')){localStorage.setItem('markdownhelper','0');window.location.reload();}});console.info('editor ready.');}
function markRequired(){var control=$(this).find(".form-control");var label=$(this).children("label");if(control.attr("required")=="required"){label.addClass("required");}}
function countCharacters(){var max=$(this).attr("maxlength");if(!max)return;var length=$(this).val().length;var counter=max-length;var helper=$(this).next().find(".form-text");helper=helper.length?helper:$(this).next().append("<span class='form-text'></span>").find(".form-text");if(counter!==1){helper.text(counter+" characters remaining");}else{helper.text(counter+" character remaining");}
if(counter===0){helper.removeClass("text-muted");helper.addClass("text-danger");}else{helper.removeClass("text-danger");helper.addClass("text-muted");}}
function init_forms(){$(".form-group").each(markRequired);$(".form-control").each(countCharacters);$(".form-control").keyup(countCharacters);}
function init_editor(){const $activateEditor=$('#activateEditor');const $longtext=$('#longtext');$longtext.first().before($activateEditor);$activateEditor.find('[data-do="activate"]').show().on('click',activate_editor);if(localStorage.getItem('markdownhelper')===null){localStorage.setItem('markdownhelper','1');}
if(localStorage.getItem('markdownhelper')=='1'){setTimeout(activate_editor,100);}}
init_editor();init_forms();}).call(this,jQuery,window);(function($,window){function createNotification(){$.get('/api/event/current/get/status',function(result){if(result.status){let eventStatus=localStorage.getItem('eventstatus');if(eventStatus==result.status)return;eventStatus=result.status;localStorage.setItem('eventstatus',eventStatus);$('#notifications-status-text').html(eventStatus);$('#global-notifications-alert').removeClass('hidden');setTimeout(function(){let userOptOut=localStorage.getItem('eventstatus-mute');if(!userOptOut){userOptOut=!window.confirm(eventStatus+
'\n\n(OK to see more alerts like this?)');}
if(userOptOut){localStorage.setItem('eventstatus-mute',1);}},500);}});};if(location.href.indexOf('/dashboard')<0){createNotification();setInterval(createNotification,60*1000);$('#notification-button').show().click(function(){$('#notifications-status-text').html('You will now receive alerts');$('#global-notifications-alert').removeClass('hidden');localStorage.removeItem('eventstatus-mute');localStorage.removeItem('eventstatus');createNotification();});}
$('#global-notifications-alert .close').click(function(){$('#global-notifications-alert').addClass('hidden');});}).call(this,jQuery,window);